<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"    content="width=device-width" />
    <meta name="theme-color" content="#59b" />
    <meta name="author"      content="M A Eyler, Istanbul, 2019" />
    <meta name="description" content="Reader for the Quran" />
    <link rel="stylesheet" href="code/reader.css" media="all">
    <!-- <link rel="manifest" href="manifest.json"> -->
    <link rel="icon" href="image/icon.png">
    <title>Iqra</title>
</head>

<body>
<nav id=div3>
  <b id=vers2></b>
  <select id=sureS></select>  
  <select id=cuzS></select>  
  <button id=pageA class=beyaz>
    <span id=page1></span>
    <span id=sayfa></span>
    <span id=search>🔎</span>
  </button>
  <button id=starA><span class=huge>☆</span></button>
  <button id=tranA>T</button>
  <button id=zoomA><span class=tiny>A</span>A</button>
  <button id=linkA>≡</button>
</nav>

<div id="bkgd">
  <div id="dialog" class="dialog">
    <label id=dia0 class=large></label>
    <input type=search id=input class="long large">
    <p>
    <button id=question>?</button>&ensp;
    <span id=recog0 class=large hidden>🎤</span>&ensp;
    <button id=main>Sayfa</button>&nbsp;
    <span id=info2 class=large></span><br>
    <span id=recog1 hidden>
      <span id=recog2 class=expert></span> &emsp;
      <input id=recog3 type=button value="x">
    </span>
    </p>
<pre id=explain hidden><span id=dia1></span>
<span id=dia2></span>
<span id=dia3></span>
<span id=dia4></span>
</pre>
    <hr />
    <details id=expert class=expert>
      <summary id=summD>For expert use only
      </summary><p>
      <!-- <input type=button id=buck value=Search> -->
      <label>Search using Buckwalter code</label><br>
      <span id=codeD class="white small">
  A b t v j H x d * r z s $ S D T Z E g f q k l m n h w y &}p
      </span>
      <input type=text id=omni class=long hidden>
    </details>
  </div>
</div>
<!--  <hr>Load simi.txt: <br>
<input type="file" onchange="fileSelect(this)" accept=".txt"> -->

<div id=div2 class="center">
  <div id=text class="hiddenNarrow paper">Menülerden sayfa/ayet seçebilirsiniz</div>
  <div id=html class="paper">Select page/verse from the menus</div>
  <div id=div0></div>
</div>

<nav id=div1>
  <div id=leftB></div>
  <input id=slider type=range min=1 max=604 value=1>
  <span  id=infoS></span>
  <div id=rightB></div>&ensp;
  <button id=noteBut></button>
</nav>
<textarea id=noteBox hidden></textarea>

<div id=wordMenu>
  <div id=menuC class=menu>
    <span id=copy class="menuK"></span>
    <span id=mujm class="menuK"></span>
    <span id=fndr class="menuK"></span>
  </div>
  <div id=wordInfo class=info>
    <span id=bilgi>root of the word</span>
    <span id=anlam class=plainSmall>meaning</span>
  </div>
  <div id=varInfo>
    <span id=stdV class=boldText>text</span>
    <span class=huge>⇩</span>
    <span id=rdrV class=plainSmall>readers</span>
    <span id=wordV class=boldText>reading</span>
    <span id=rgnV class=plainSmall>regions</span>
    <span id=rasmV>rasm</span>
  </div>
</div>

<div id=verseMenu>
  <div id=menuV class=menu>
    <span id=pay2 class="menuK"></span>
    <hr>
    <div id=kay2 class="black"></div>
    <span id="tanzil" class="menuK">tanzil.net</span>
    <span id="quranc" class="menuK">quran.com</span>
    <span id="awaken" class="menuK">islamawakened</span>
    <span id="corpus" class="menuK">corpus.quran.com</span>
    <span id="coranv" class="menuK">corpuscoranicum</span>
    <hr>
    <span id="acikur" class="menuK">acikkuran.com</span>
    <span id="diyant" class="menuK">diyanet.gov.tr</span>
    <span id="kuranm" class="menuK">kuranmeali.com</span>
    <span id="mufrdt" class="menuK">el-mufredat</span>
    <span id="elktbn" class="menuK">elktb.net</span>
  </div>
  <div id=simInfo class="info plainSmall">
    <div id=similar></div>
    <div id=simiList></div>
  </div>
</div>

<div id=menuS class="menu bubble">
  <span id=starB class="menuK">Yıldız Ekle</span>
  <span id=starH class="menuK hidden">Yıldız Kaldır</span>
  <hr>
  <span id=starred>star menu</span>
</div>

<div id=menuT class="menu bubble">
  <span id=tranB class="menuK">Meal göster</span>
  <span id=tranH class="menuK hidden">Meal gizle</span>
  <div> &nbsp;
    <span id=hare1 class="hareke"> </span>
    <span id=hare2 class="hareke"> </span>
    <span id=hare3 class="hareke"> </span>
  </div>
  <hr>
  <span id=3 class="menuK">TR &ensp; Diyanet</span>
  <span id=5 class="menuK">TR &ensp; Elmalılı</span>
  <span id=4 class="menuK">EN &ensp; Ahmed Ali</span>
  <span id=6 class="menuK">EN &ensp; Yusuf Ali</span>
  <span id=8 class="menuK">EN &ensp; Pickthall</span>
  <span id=7 class="menuK">FR &ensp; Hamidullah</span>
  <span id=10 class="menuK">DE &ensp; Amir Zaidan</span>
  <span id=9 class="menuK">TR &ensp; Çeviriyazı</span>
  <span id=2 class="menuK">AR &ensp; الجلالين</span>
  <span id=11 class="menuK">AR &ensp; الميسر</span>
  <hr>
  <span class="menuK"><span id=kaynak></span>
    <a href="https://tanzil.net/trans/" target="Kuran">tanzil.net</a>
  </span>
</div>

<div id=menuK class="menu bubble">
   <span id=yardim class="menuK"></span>
   <span id=pay1 class="menuK"></span>
   <hr>
   <div id=kay1 class="black"></div>
   <span id="tanzil" class="menuK">tanzil.net</span>
   <span id="quranc" class="menuK">quran.com</span>
   <span id="coranp" class="menuK">Cairo 1924</span>
   <span id="diyant" class="menuK">diyanet.gov.tr</span>
   <span id="kuranm" class="menuK">kuranmeali.com</span>
   <hr>
   <span class="black version">
    <span id=vers1></span>&ensp;
    <span class="hareke" id=add2hs></span>
   </span>
   <span class="menuK checked" id=update>
      <b>Update</b>
      <span class=large>⇧</span> — F5
   </span>
   <!-- display property overrides the hidden attribute -->
   <hr>
   <span id=notes class="menuK"></span>
   <span id=topic class="menuK"></span>
   <span id=ders class="menuK"></span>
</div>

<script src="code/languages.js"></script>
<script src="code/buckwalter.js"></script>
<script src="code/common.js"></script>
<script src="code/model.js"></script>
<script>//localization strings
const localization = {};

localization.tr = 
`page1	innerText	Sayfa
dia0	innerText	  Ara ve Bul
dia1	innerText	  sayfa: 378 (1-604 arası)
dia2	innerText	  ayet: 27.30 (nokta/boşluk)
dia3	innerText	  kök: ktb Elm (Mucem'de ara)
dia4	innerText	  diğer: (Rehber'de ara)
main	data2	Sure
main	data3	Ayet
main	data4	Mucem
main	data5	Rehber
input	placeholder	sayfa, ayet, kök, metin
input	title	sayfa ya da sure-ayet numaraları; aranacak kök ya da metin
copy	innerText	Kopyala
mujm	innerText	Mucem
mufrdt	innerText	el-Mufredat
fndr	innerText	Rehber
leftB	title	Önceki sayfa
slider	title	Aranan sayfaya geçmek için slider
rightB	title	Sonraki sayfa
noteBut	title	Bu sayfa hakkında notlar ekleyin
sureS	title	Sure seçin (liste mushaf sırasında)
cuzS	title	Cüz numarası seçin
cuzS	name	Cüz
pageA	title	Sayfa ya da ayet seçin
zoomA	title	Sayfayı geçici olarak büyüt
starB	innerText	Yıldız Ekle
starH	innerText	Yıldız Kaldır
tranB	innerText	Meal göster — T
tranH	innerText	Meal gizle — T
hare1	title	Noktasız Kufi font
hare2	title	Harekeleri gizle
hare3	title	Harekeleri göster
kaynak	innerText	Kaynak:
yardim	innerText	Yardım — F1
pay1	innerText	Paylaş (sayfa)
kay1	innerText	Dış kaynaklar:
add2hs	title	"Iqra Quran Reader" uygulamasını yükle
pay2	innerText	Paylaş (ayet)...
kay2	innerText	Dış kaynaklar
similar	innerText	Benzer
topic	innerText	Konular
notes	innerText	Başlangıç
ders	innerText	Kitap
recog2	innerText	Arapça dinliyorum...
summD	title	Buckwalter kodunu göster/gizle
codeD	title	Buckwalter kodu -- alfabetik sıra`

localization.en = 
`page1	innerText	Page
dia0	innerText	  Search and Find
dia1	innerText	  page: 378 (within 1-604)
dia2	innerText	  verse: 27.30 (period/space)
dia3	innerText	  root: ktb Elm (in Mujam)
dia4	innerText	  other: (in Finder)
main	data2	Surah
main	data3	Verse
main	data4	Mujam
main	data5	Finder
input	placeholder	page, verse, root, or text
input	title	Page or verse number; root or text to search
copy	innerText	Copy
mujm	innerText	Mujam
mufrdt	innerText	al-Mufradat
fndr	innerText	Finder
leftB	title	Previous page
slider	title	Slider to view the desired page
rightB	title	Next page
noteBut	title	Add comments about this page
sureS	title	Select chapter
cuzS	title	Select juz number (20 pages)
cuzS	name	Juz
pageA	title	Enter page or verse number
zoomA	title	Zoom in/out (change size)
starB	innerText	Add bookmark
starH	innerText	Remove bookmark
tranB	innerText	Show translation
tranH	innerText	Hide translation
hare1	title	Undotted Kufi font
hare2	title	Hide tashkeel (vowels)
hare3	title	Show tashkeel (vowels)
kaynak	innerText	Source:
yardim	innerText	Help — F1
pay1	innerText	Share (page)
kay1	innerText	External sources:
add2hs	title	Install "Iqra Quran Reader"
pay2	innerText	Share (verse)...
kay2	innerText	External sources
similar	innerText	Similar
topic	innerText	Topics
notes	innerText	Startup
ders	innerText	Kitab
recog2	innerText	Listening in Arabic...
summD	title	Show/Hide Buckwalter code
codeD	title	Buckwalter code -- dictionary order`

localization.ar = 
`page1	innerText	صفحة
dia0	innerText	  البحث والعثور
dia1	innerText	  صفحة: 378 (1-604)
dia2	innerText	  آية: 27.30 
dia3	innerText	  المعجم: كتب علم
dia4	innerText	  النص المراد البحث عنه
main	data2	سورة
main	data3	آية
main	data4	المعجم
main	data5	الباحث
input	placeholder	378 أو 27.30
input	title	رقم الصفحة أو رقم السورة والجزء
copy	innerText	انسخ
mujm	innerText	المعجم
mufrdt	innerText	المفردات
fndr	innerText	باحث قرآني
leftB	title	صفحة سابقة
slider	title	شريط تحريك لرؤية الصفحة المطلوبة
rightB	title	الصفحة التالية
noteBut	title	أضف تعليقات على هذه الصفحة
sureS	title	اختر سورة
cuzS	title	اختر جزء
cuzS	name	جزء
pageA	title	أدخل رقم صفحة أو آية
zoomA	title   تكبير داخلي/خارجي (تغيير الحجم)
starB	innerText	أضف علامة مرجعية
starH	innerText	إزالة علامة مرجعية
tranB	innerText	أظهر الترجمة
tranH	innerText	أخفي الترجمة
hare1	title	Undotted Kufi font
hare2	title	Hide tashkeel (vowels)
hare3	title	Show tashkeel (vowels)
kaynak	innerText	مصدر:
yardim	innerText	مساعدة — F1
pay1	innerText	شارك (صفحة)
kay1	innerText	مصادر خارجية
add2hs	title	تثبيت "Iqra Quran Reader"
pay2	innerText	شارك (آية)...
kay2	innerText	مصادر خارجية
similar	innerText	Similar
topic	innerText	المواضيع
notes	innerText	البدء
ders	innerText	الدروس
recog2	innerText	يتم تسجيل الصوت...
summD	title	إظهار/إخفاء رمز Buckwalter
codeD	title	Buckwalter code -- ترتيب القاموس`

function languageItems() {
    let k1 = sureS.selectedIndex 
    sName = suraNames[currentLanguage()]
    let labels = []
    for (let i=1; i<=114; i++)
      labels.push(i+'. '+sName[i])
    sureS.innerHTML = '<option>'+labels.join('<option>')
    if (k1) sureS.selectedIndex = k1
    let k2 = cuzS.selectedIndex 
    labels = []
    for (let i=1; i<=30; i++)
      labels.push(cuzS.name+' '+i)
    cuzS.innerHTML = '<option>'+labels.join('<option>')
    if (k2) cuzS.selectedIndex = k2
    LangManager.adjustDirection(infoS)
    LangManager.adjustDirection(bkgd)
    if (window.Q) Q.dict = Dictionary.newInstance()
}
const langMgr = new LangManager(languageItems) 
</script>
<script src="code/search.js"></script>
<script src="code/utilities.js"></script>
<script src="code/reader.js"></script>

<script>
"use strict";
console.log('init', nChap + " suras -> " + nVerse);
const RDR = new FileReader()
RDR.onload = () => {
  Q.simi.setData(RDR.result, refreshPage)
}
function fileSelect(t) { 
//t is the file selection HTMLInputElement
  console.log("fileSelect", t.files[0])
  RDR.readAsText(t.files[0])
  hideElement(bkgd)
}

    if (navigator.serviceWorker) {
        navigator.serviceWorker.register('sw.js')
        .then(reg => { console.log('Service worker', reg.scope) })
        .catch(alert)
    }
    //initReader()
    
/**
 * BeforeInstallPromptEvent saved for later use
 */
 var pevt
/**
 * Prevent Chrome from showing the InstallPrompt
 * from  https://love2dev.com/blog/beforeinstallprompt/
 * 
 * @param {BeforeInstallPromptEvent} e 
 */
function beforeinstallCB(e) {
  function addToHomeScreen() {
    pevt.prompt()  //ask user
    pevt.userChoice.then(console.log)
    add2hs.style.display = 'none'
    pevt = null; hideMenus()
  }
    e.preventDefault(); pevt = e
    add2hs.style.display = '' //show button
    add2hs.onclick = addToHomeScreen
}
window.onbeforeinstallprompt = beforeinstallCB
add2hs.style.display = 'none' //hide button at start
update.style.display = 'none' 
</script>
</body>
</html>
