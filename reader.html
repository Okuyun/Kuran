<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"    content="width=device-width" />
    <meta name="theme-color" content="#59b" />
    <meta name="author"      content="M A Eyler, Istanbul, 2019" />
    <meta name="description" content="Reader for the Quran" />
    <link rel="stylesheet" href="code/reader.css" media="all">
    <!-- <link rel="manifest" href="manifest.json"> -->
    <link rel="icon" href="image/icon.png">
    <title>Iqra</title>
</head>

<body>
<nav id=div3>
  <b id=vers2></b>
  <select id=sureS></select>  
  <button id=pageA>
    <span id=page1></span> <span id=sayfa></span>
  </button>
  <button id=starA>&nbsp;</button>
  <button id=tranA>&nbsp;</button>
  <button id=zoomA>&nbsp;</button>
  <button id=linkA>&nbsp;</button>
</nav>

<div id="bkgd">
  <div class="dialog">
    <span id=page2></span>
    <input id=pgNum type=text inputmode=decimal>
    <button id=dialogOK title="OK">✔</button>
<pre><span id=dia1></span>
<span id=dia2></span>
<span id=dia3></span>
<span id=dia4></span></pre>
<hr>Load simi.txt: <br>
<input type="file" onchange="fileSelect(this)" accept=".txt">
</div>
</div>

<div id=div2 class="center">
  <div id=text class=hiddenNarrow>Türkçe meal yükleniyor</div>
  <div id=html readonly>Kuran metni yükleniyor</div>
  <div id=div0></div>
</div>

<nav id=div1>
  <div id=leftB></div>
  <input id=slider type=range min=1 max=604 value=1>
  <span  id=infoS></span>
  <div id=rightB></div>&ensp;
  <button id=noteBut></button>
</nav>
<textarea id=noteBox hidden></textarea>

<span id=bilgi>tooltip for each word and each verse</span>

<div id=menuS class="menu bubble">
  <span id=starB class="menuK">Yıldız Ekle</span>
  <span id=starH class="menuK hidden">Yıldız Kaldır</span>
  <hr>
  <span id=starred>star menu</span>
</div>

<div id=menuT class="menu bubble">
  <span id=tranB class="menuK">Meal göster</span>
  <span id=tranH class="menuK hidden">Meal gizle</span>
  <span id=hareB class="menuK hidden">Harekeleri göster</span>
  <span id=hareH class="menuK">Harekeleri gizle</span>
  <hr>
  <span id=3 class="menuK">TR &ensp; Diyanet</span>
  <span id=5 class="menuK">TR &ensp; Elmalılı</span>
  <span id=4 class="menuK">EN &ensp; Ahmed Ali</span>
  <span id=6 class="menuK">EN &ensp; Yusuf Ali</span>
  <span id=8 class="menuK">EN &ensp; Pickthall</span>
  <span id=7 class="menuK">FR &ensp; Hamidullah</span>
  <span id=10 class="menuK">DE &ensp; Amir Zaidan</span>
  <span id=9 class="menuK">TR &ensp; Çeviriyazı</span>
  <span id=2 class="menuK">AR &ensp; الجلالين</span>
  <span id=11 class="menuK">AR &ensp; الميسر</span>
  <hr>
  <span class="menuK"><span id=kaynak></span>
    <a href="https://tanzil.net/trans/" target="Kuran">tanzil.net</a>
  </span>
</div>

<div id=menuC class=menu>
   <span id=copy class="menuC"></span>
   <span id=mujm class="menuC"></span>
   <span id=fndr class="menuC"></span>
   <!--span class="menuC">Benzer</span-->
</div>

<div id=menuK class="menu bubble">
   <span id=yardim class="menuK"></span>
   <span id=pay1 class="menuK"></span>
   <hr><div id=kay1 class="black"></div>
   <span class="menuK">tanzil.net</span>
   <span class="menuK">quran.com</span>
   <span class="menuK">diyanet.gov.tr</span>
   <span class="menuK">kuranmeali.com</span>
   <hr><div class="black" id=vers1></div>
   <span class="menuK" id=add2hs hidden>Install PWA</span>
   <!-- display property overrides the hidden attribute -->
</div>

<div id=menuV class=menu>
   <span id=pay2 class="menuK"></span>
   <hr><div id=kay2 class="black"></div>
   <span class="menuK">tanzil.net</span>
   <span class="menuK">quran.com</span>
   <span class="menuK">corpus.quran.com</span>
   <span class="menuK">diyanet.gov.tr</span>
   <span class="menuK">kuranmeali.com</span>
   <span class="menuK">acikkuran.com</span>
</div>

<script src="code/languages.js"></script>
<script src="code/buckwalter.js"></script>
<script src="code/common.js"></script>
<script src="code/model.js"></script>
<script>//localization strings
const localization = {};

localization.tr = 
`page1	innerText	Sayfa
page2	innerText	Sayfa/Ayet
dia1	innerText	36   = Sayfa 36
dia2	innerText	36.  = Sure 36 (Yasin)
dia3	innerText	36.8 = Yasin 8. ayet
dia4	innerText	(nokta ya da boşluk)
copy	innerText	Kopyala
mujm	innerText	Mucem
fndr	innerText	Rehber
leftB	title	Önceki sayfa
slider	title	Aranan sayfaya geçmek için slider
rightB	title	Sonraki sayfa
noteBut	title	Bu sayfa hakkında notlar ekleyin
sureS	title	Sure seçin (liste mushaf sırasında)
pageA	title	Sayfa ya da ayet seçin
zoomA	title	Sayfayı geçici olarak büyüt
starB	innerText	Yıldız Ekle
starH	innerText	Yıldız Kaldır
tranB	innerText	Meal göster — T
tranH	innerText	Meal gizle — T
hareB	innerText	Harekeleri göster
hareH	innerText	Harekeleri gizle
kaynak	innerText	Kaynak:
yardim	innerText	Yardım — F1
pay1	innerText	Paylaş (sayfa)
kay1	innerText	Dış kaynaklar:
add2hs	title	Web sayfasını uygulama olarak aç
pay2	innerText	Paylaş (ayet)...
kay2	innerText	Dış kaynaklar`

localization.en = 
`page1	innerText	Page
page2	innerText	Page/Verse
dia1	innerText	36   = Page 36
dia2	innerText	36.  = Chap 36 (Yasin)
dia3	innerText	36.8 = Yasin, verse #8
dia4	innerText	(period or space)
copy	innerText	Copy
mujm	innerText	Mujam
fndr	innerText	Finder
leftB	title	Previous page
slider	title	Slider to view the desired page
rightB	title	Next page
noteBut	title	Add comments about this page
sureS	title	Select chapter
pageA	title	Enter page or verse number
zoomA	title	Zoom in/out (change size)
starB	innerText	Add bookmark
starH	innerText	Remove bookmark
tranB	innerText	Show translation
tranH	innerText	Hide translation
hareB	innerText	Show vowels
hareH	innerText	Hide vowels
kaynak	innerText	Source:
yardim	innerText	Help — F1
pay1	innerText	Share (page)
kay1	innerText	External sources:
add2hs	title	Install web page as application
pay2	innerText	Share (verse)...
kay2	innerText	External sources`


localization.ar = 
`page1	innerText	صفحة
page2	innerText	صفحة/آية
dia1	innerText	36   = صفحة 36
dia2	innerText	36.  = سورة 36 (ياسين)
dia3	innerText	36.8 = ياسين, آية #8
dia4	innerText	(نقطة أو مسافة)
copy	innerText	انسخ
mujm	innerText	معجم
fndr	innerText	باحث قرآني
leftB	title	صفحة سابقة
slider	title	شريط تحريك لرؤية الصفحة المطلوبة
rightB	title	الصفحة التالية
noteBut	title	أضف تعليقات على هذه الصفحة
sureS	title	اختر سورة
pageA	title	أدخل رقم صفحة أو آية
zoomA	title   تكبير داخلي/خارجي (تغيير الحجم)
starB	innerText	أضف علامة مرجعية
starH	innerText	إزالة علامة مرجعية
tranB	innerText	أظهر الترجمة
tranH	innerText	أخفي الترجمة
hareB	innerText	أظهر الحركات
hareH	innerText	أخفي الحركات
kaynak	innerText	مصدر:
yardim	innerText	مساعدة — F1
pay1	innerText	شارك (صفحة)
kay1	innerText	مصادر خارجية:
add2hs	title	تثبيت الصفحة كتطبيق
pay2	innerText	شارك (آية)...
kay2	innerText	مصادر خارجية`

function setSuraMenu() {
    let i = sureS.selectedIndex 
    sName = suraNames[currentLanguage()]
    let labels = []
    for (let i=1; i<=114; i++)
      labels.push(i+'. '+sName[i])
    sureS.innerHTML = '<option>'+labels.join('<option>')
    if (i) sureS.selectedIndex = i
}
let langMgr = new LangManager(setSuraMenu) 
</script>
<script src="code/utilities.js"></script>
<script src="code/reader.js"></script>

<script>
"use strict";
const RDR = new FileReader()
RDR.onload = () => {
  Q.simi.setData(RDR.result, refreshPage)
}
function fileSelect(t) { 
//t is the file selection HTMLInputElement
  console.log("fileSelect", t.files[0])
  RDR.readAsText(t.files[0])
  hideElement(bkgd)
}

    if (navigator.serviceWorker) {
        navigator.serviceWorker.register('sw.js')
        .then(reg => { console.log('Service worker', reg.scope) })
        .catch(alert)
    }
    //initReader()
    
/**
 * BeforeInstallPromptEvent saved for later use
 */
 var pevt
/**
 * Prevent Chrome from showing the InstallPrompt
 * from  https://love2dev.com/blog/beforeinstallprompt/
 * 
 * @param {BeforeInstallPromptEvent} e 
 */
function beforeinstallCB(e) {
  function addToHomeScreen() {
    pevt.prompt()  //ask user
    pevt.userChoice.then(console.log)
    add2hs.style.display = 'none'
    pevt = null; hideMenus()
  }
    e.preventDefault(); pevt = e
    add2hs.style.display = '' //show button
    add2hs.onclick = addToHomeScreen
}
window.onbeforeinstallprompt = beforeinstallCB
add2hs.style.display = 'none' //hide button at start
</script>
</body>
</html>
